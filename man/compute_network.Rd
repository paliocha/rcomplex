% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/network.R
\name{compute_network}
\alias{compute_network}
\title{Compute co-expression network from an expression matrix}
\usage{
compute_network(
  expr_matrix,
  cor_method = c("pearson", "spearman"),
  norm_method = c("MR", "CLR"),
  density = 0.03,
  abs_cor = FALSE,
  mr_log_transform = FALSE,
  min_var = 0,
  n_cores = 1L
)
}
\arguments{
\item{expr_matrix}{Numeric matrix of expression values (genes x samples).
Row names must be gene identifiers.}

\item{cor_method}{Correlation method: \code{"pearson"} (default) or \code{"spearman"}.}

\item{norm_method}{Normalization method: \code{"MR"} (Mutual Rank, default) or
\code{"CLR"} (Context Likelihood Ratio).}

\item{density}{Fraction of top edges to keep (default 0.03 = 3\%).}

\item{abs_cor}{If \code{TRUE}, take absolute value of correlations before
normalization (default \code{FALSE}).}

\item{mr_log_transform}{If \code{FALSE} (default), use the raw MR formula
matching the original RComPlEx R Markdown. If \code{TRUE}, use Obayashi &
Kinoshita (2009) log-normalized formula (values in [0,1]).}

\item{min_var}{Minimum row variance threshold. Genes with variance below
this value are removed before computing correlations. Default \code{0} removes
only constant genes (zero variance). Set to a positive value (e.g. \code{1e-3})
to also remove near-invariant genes that produce noisy correlations.
Set to \code{NULL} to disable filtering entirely.}

\item{n_cores}{Number of threads for parallel computation (default 1).}
}
\value{
A list with components:
\describe{
\item{network}{Named symmetric matrix (genes x genes) with normalized
co-expression values. Diagonal is set to 0.}
\item{threshold}{The co-expression threshold at the given density.}
\item{n_genes}{Number of genes in the network.}
\item{n_removed}{Number of genes removed by variance filter (0 if
\code{min_var} is \code{NULL}).}
\item{params}{List of parameters used.}
}
}
\description{
Calculates correlation, applies normalization (Mutual Rank or CLR),
and determines a density-based co-expression threshold.
}

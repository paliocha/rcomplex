% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/summary.R
\name{summarize_hog_comparison}
\alias{summarize_hog_comparison}
\title{Summarize neighborhood comparison at the HOG level using Fisher's method}
\usage{
summarize_hog_comparison(
  comparison,
  alternative = c("greater", "less"),
  fdr_method = "fdr"
)
}
\arguments{
\item{comparison}{Data frame from \code{\link[=compare_neighborhoods]{compare_neighborhoods()}} â€” raw p-values,
\strong{not} FDR-corrected. FDR correction is applied to the HOG-level p-values.}

\item{alternative}{Which tail to test: \code{"greater"} for conservation
(uses \code{.p.val.con} columns) or \code{"less"} for divergence
(uses \code{.p.val.div} columns).}

\item{fdr_method}{P-value adjustment method passed to \code{\link[=p.adjust]{p.adjust()}}
(default \code{"fdr"}).}
}
\value{
A data frame with one row per HOG, ordered by p-value, with columns:
\describe{
\item{OrthoGroup}{HOG identifier}
\item{n_pairs}{Number of ortholog pairs in this HOG}
\item{fisher_stat}{Fisher's combined statistic (-2 * sum(log(p)))}
\item{mean_eff}{Mean geometric-mean effect size across pairs}
\item{min_eff}{Minimum geometric-mean effect size across pairs}
\item{df}{Degrees of freedom (2 * n_pairs)}
\item{p.value}{P-value from chi-squared test}
\item{q.value}{FDR-adjusted p-value}
}
}
\description{
Combines per-pair p-values within each Hierarchical Ortholog Group (HOG)
using Fisher's method for combining independent tests. This replaces
gene-level significance checks with a proper aggregate test that accounts
for both the number and strength of significant pairs within a HOG.
}
\details{
For each HOG, the combined p-value per pair is \code{pmax(Species1.p, Species2.p)}
(reciprocal criterion), then Fisher's statistic is computed as
\code{T = -2 * sum(log(p_i))} which follows a chi-squared distribution with
\verb{df = 2k} under the null (k = number of pairs).

For single-pair HOGs (1:1 orthologs), Fisher's test reduces exactly to the
original pair-level test.
}

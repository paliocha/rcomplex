% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/comparison.R
\name{compare_neighborhoods}
\alias{compare_neighborhoods}
\title{Compare co-expression neighborhoods across species}
\usage{
compare_neighborhoods(net1, net2, orthologs, n_cores = 1L)
}
\arguments{
\item{net1}{Network object for species 1 (output of \code{\link[=compute_network]{compute_network()}}).}

\item{net2}{Network object for species 2 (output of \code{\link[=compute_network]{compute_network()}}).}

\item{orthologs}{Data frame with columns \code{Species1}, \code{Species2}, and
\code{OrthoGroup} (output of \code{\link[=parse_orthologs]{parse_orthologs()}}).}

\item{n_cores}{Number of threads for parallel computation (default 1).}
}
\value{
A data frame with columns:
\describe{
\item{Species1}{Gene identifier for species 1}
\item{Species2}{Gene identifier for species 2}
\item{OrthoGroup}{Ortholog group identifier}
\item{Species1.neigh}{Number of neighbors of Species1 gene in net1}
\item{Species1.ortho.neigh}{Number of ortholog-mapped neighbors from net2}
\item{Species1.neigh.overlap}{Intersection size}
\item{Species1.p.val.con}{Upper-tail hypergeometric p-value for
conservation (direction 1)}
\item{Species1.p.val.div}{Lower-tail hypergeometric p-value for
divergence (direction 1)}
\item{Species1.effect.size}{Fold enrichment (direction 1). Values > 1
indicate conservation, < 1 indicate divergence.}
\item{Species2.neigh}{Number of neighbors of Species2 gene in net2}
\item{Species2.ortho.neigh}{Number of ortholog-mapped neighbors from net1}
\item{Species2.neigh.overlap}{Intersection size}
\item{Species2.p.val.con}{Upper-tail hypergeometric p-value for
conservation (direction 2)}
\item{Species2.p.val.div}{Lower-tail hypergeometric p-value for
divergence (direction 2)}
\item{Species2.effect.size}{Fold enrichment (direction 2). Values > 1
indicate conservation, < 1 indicate divergence.}
}
}
\description{
For each ortholog pair, tests whether co-expression neighborhoods are
conserved between species using hypergeometric tests in both directions.
}
\section{Ortholog preparation for de novo transcriptomes}{

When working with de novo transcriptome assemblies, it is \strong{critical} to
filter ortholog tables to expressed genes \strong{before} applying any
maximum-paralogs filter. De novo assemblies can produce 10--50x more gene
models than are actually expressed (e.g. 205K models but only 14K expressed).
Unexpressed fragments inflate paralog counts per ortholog group, causing the
paralogs filter to discard groups that would pass if only expressed members
were counted. Failing to do this can reduce the usable gene set by 40--70\%
and eliminate all statistical power from the hypergeometric test.

Recommended workflow:
\enumerate{
\item Build expression matrices for both species
\item Filter ortholog table to genes present in expression data
\item Apply maximum-paralogs filter on the reduced ortholog table
\item Compute networks and run comparison
}
}

